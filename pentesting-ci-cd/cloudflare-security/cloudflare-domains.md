# Cloudflare Domains

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)

Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

**Join the** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

**Share your hacking tricks submitting PRs to the** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)**.**

</details>

In each TLD configured in Cloudflare there are some **general settings and services** that can be configured. In this page we are going to **analyze the security related settings of each section:**

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

## Overview

* [ ] Get a feeling of **how much** are the services of the account **used**
* [ ] Find also the **zone ID** and the **account ID**

## Analytics

* [ ] In **`Security`** check if there is any **Rate limiting**&#x20;

## DNS

* [ ] Check **interesting** (sensitive?) data in DNS **records**
* [ ] Check for **subdomains** that could contain **sensitive info** just based on the **name** (like admin173865324.domin.com)
* [ ] Check for web pages that **aren't** **proxied**
* [ ] Check for **proxified web pages** that can be **accessed directly** by CNAME or IP address
* [ ] Check that **DNSSEC** is **enabled**
* [ ] Check that **CNAME Flattening** is **used** in **all CNAMEs**
  * This is could be useful to **hide subdomain takeover vulnerabilities** and improve load timings
* [ ] Check that the domains [**aren't vulnerable to spoofing**](https://book.hacktricks.xyz/network-services-pentesting/pentesting-smtp#mail-spoofing)****

## **Email**

TODO

## Spectrum

TODO

## SSL/TLS

### **Overview**

* [ ] The **SSL/TLS encryption** should be **Full** or **Full (Strict)**. Any other will send **clear-text traffic** at some point.
* [ ] The **SSL/TLS Recommender** should be enabled

### Edge Certificates

* [ ] **Always Use HTTPS** should be **enabled**
* [ ] **HTTP Strict Transport Security (HSTS)** should be **enabled**
* [ ] **Minimum TLS Version should be 1.2**
* [ ] **TLS 1.3 should be enabled**
* [ ] **Automatic HTTPS Rewrites** should be **enabled**
* [ ] **Certificate Transparency Monitoring** should be **enabled**

## **Security**

* [ ] In the **`WAF`** section it's interesting to check that **Firewall** and **rate limiting rules are used** to prevent abuses.
  * The **`Bypass`** action will **disable Cloudflare security** features for a request. It shouldn't be used.
* [ ] In the **`Page Shield`** section it's recommended to check that it's **enabled** if any page is used
* [ ] In the **`API Shield`** section it's recommended to check that it's **enabled** if any API is exposed in Cloudflare
* [ ] In the **`DDoS`** section it's recommended to enable the **DDoS protections**
* [ ] In the **`Settings`** section:
  * [ ] Check that the **`Security Level`** is **medium** or greater
  * [ ] Check that the **`Challenge Passage`** is 1 hour at max
  * [ ] Check that the **`Browser Integrity Check`** is **enabled**
  * [ ] Check that the **`Privacy Pass Support`** is **enabled**

## Access

{% content-ref url="cloudflare-zero-trust-network.md" %}
[cloudflare-zero-trust-network.md](cloudflare-zero-trust-network.md)
{% endcontent-ref %}

## Speed

_I couldn't find any option related to security_

## Caching

* [ ] In the **`Configuration`** section consider enabling the **CSAM Scanning Tool**

## **Workers Routes**

_You should have already checked_ [_cloudflare workers_](./#workers)__

## Rules

TODO

## Network

* [ ] If **`HTTP/2`** is **enabled**, **`HTTP/2 to Origin`** should be **enabled**
* [ ] **`HTTP/3 (with QUIC)`** should be **enabled**
* [ ] If the **privacy** of your **users** is important, make sure **`Onion Routing`** is **enabled**

## **Traffic**

TODO

## Custom Pages

* [ ] It's optional to configure custom pages when an error related to security is triggered (like a block, rate limiting or I'm under attack mode)&#x20;

## Apps

TODO

## Scrape Shield

* [ ] Check **Email Address Obfuscation** is **enabled**
* [ ] Check **Server-side Excludes** is **enabled**

## **Zaraz**

TODO

## **Web3**

TODO

<details>

<summary><strong>Support HackTricks and get benefits!</strong></summary>

Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)

Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

**Join the** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/carlospolopm)**.**

**Share your hacking tricks submitting PRs to the** [**hacktricks github repo**](https://github.com/carlospolop/hacktricks)**.**

</details>
